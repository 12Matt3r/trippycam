        @keyframes rainbowText {
            0% { color: #ff00ff; text-shadow: 0 0 7px #ff00ff; } 16% { color: #007bff; text-shadow: 0 0 7px #007bff; } 33% { color: #00ff00; text-shadow: 0 0 7px #00ff00; } 50% { color: #ffff00; text-shadow: 0 0 7px #ffff00; } 66% { color: #ff7f00; text-shadow: 0 0 7px #ff7f00; } 83% { color: #ff0000; text-shadow: 0 0 7px #ff0000; } 100% { color: #ff00ff; text-shadow: 0 0 7px #ff00ff; }
        }
        @keyframes rainbowBackground {
            0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; }
        }
        @keyframes blink {
            0%, 100% { opacity: 1; } 50% { opacity: 0.4; }
        }
        html, body { margin: 0; padding: 0; overflow: hidden; width: 100%; height: 100%; background-color: #0a0a0f; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; color: #e8e8e8; }
        canvas { display: block; width: 100%; height: 100%; object-fit: contain; }
        #errorMessage { position: absolute; top: 10px; left: 10px; background-color: rgba(255, 0, 100, 0.9); padding: 12px; border-radius: 6px; display: none; z-index: 1001; color: white; font-size: 14px; box-shadow: 0 0 20px rgba(255,0,100,0.7); }
        #webcamVideo { position: absolute; top: -9999px; left: -9999px; }
        #controls { position: absolute; bottom: 10px; left: 10px; background-color: rgba(15, 18, 28, 0.65); padding: 12px; border-radius: 12px; font-size: 12px; display: flex; flex-direction: column; width: 290px; max-width: 90vw; max-height: 88vh; z-index: 1000; overflow: hidden; min-width: 240px; border: 1px solid rgba(70, 80, 110, 0.8); box-shadow: 0 8px 35px rgba(0,0,0,0.6), 0 0 50px rgba(100, 150, 255, 0.1); transition: height 0.3s cubic-bezier(0.25, 0.1, 0.25, 1), min-height 0.3s cubic-bezier(0.25, 0.1, 0.25, 1), opacity 0.3s ease-out; }
        #controlsHeader { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; padding-bottom: 8px; border-bottom: 1px solid rgba(60, 70, 95, 0.8); position: relative; }
        #headerButtons { display: flex; align-items: center; gap: 8px; }
        #controlsTitle { font-weight: 700; font-size: 18px; animation: rainbowText 10s linear infinite; margin-right: auto; }
        #minimizeButton { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(120, 150, 200, 0.5); color: #aaa; cursor: pointer; padding: 0; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; transition: background-color 0.2s, transform 0.2s, color 0.2s, box-shadow 0.2s; flex-shrink: 0; }
        #minimizeButton:hover { background: rgba(255, 255, 255, 0.15); color: #fff; transform: scale(1.15); box-shadow: 0 0 10px rgba(150, 180, 255, 0.5); }
        #minimizeButton svg { width: 12px; height: 12px; fill: currentColor; }
        #controlsContent { overflow-y: auto; overflow-x: hidden; padding-right: 3px; display: flex; flex-direction: column; gap: 10px; transition: opacity 0.2s 0.1s ease-out; }
        #controls.minimized { height: 52px !important; min-height: 52px !important; background-color: rgba(15, 18, 28, 0.55); }
        #controls.minimized #controlsContent, #controls.minimized #resizeHandle { opacity: 0; pointer-events: none; }
        #controls .main-action-button { width: 100%; box-sizing: border-box; margin-top: 6px; padding: 7px 10px; background: linear-gradient(120deg, red, orange, yellow, green, blue, indigo, violet, red); background-size: 300% 300%; animation: rainbowBackground 8s linear infinite; border: none; color: white; cursor: pointer; border-radius: 6px; font-size: 12px; font-weight: 600; transition: transform 0.15s ease, box-shadow 0.15s ease; text-shadow: 0 1px 3px rgba(0,0,0,0.3); }
        #controls .main-action-button:hover { transform: translateY(-2px) scale(1.02); box-shadow: 0 6px 15px rgba(0,0,0,0.2); }
        #controls .main-action-button:active { transform: translateY(0px) scale(1); animation-duration: 4s; }
        #controls .main-action-button:disabled { background-image: none; background-color: #3a3a45; color: #777; cursor: default; transform: none; box-shadow: none; animation: none; }
        .control-group { display: flex; flex-wrap: nowrap; align-items: center; gap: 8px; }
        .control-group label { flex-basis: 75px; flex-shrink: 0; font-size: 12.5px; font-weight: 500; color: #77ccff; text-shadow: 0 0 5px rgba(100, 200, 255, 0.5); }
        .control-group input[type="range"] { flex-grow: 1; min-width: 80px; height: 20px; margin: 0; -webkit-appearance: none; appearance: none; background: transparent; cursor: pointer; }
        .control-group input[type="range"]::-webkit-slider-runnable-track { height: 10px; background: linear-gradient(90deg, #ff00ff, #00ffff, #ffff00, #ff00ff, #00ffff, #ffff00); background-size: 400% 100%; animation: rainbowBackground 12s linear infinite; border-radius: 5px; box-shadow: inset 0 1px 3px rgba(0,0,0,0.4); }
        .control-group input[type="range"]::-moz-range-track { height: 10px; background: linear-gradient(90deg, #ff00ff, #00ffff, #ffff00, #ff00ff, #00ffff, #ffff00); background-size: 400% 100%; animation: rainbowBackground 12s linear infinite; border-radius: 5px; border: none; }
        .control-group input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; height: 18px; width: 18px; background-color: #ffffff; border-radius: 50%; border: 2px solid #10121a; box-shadow: 0 0 6px #fff, 0 0 12px #fff, 0 0 18px rgba(200,220,255,0.8); margin-top: -4px; }
        .control-group input[type="range"]::-moz-range-thumb { height: 16px; width: 16px; background-color: #ffffff; border-radius: 50%; border: 2px solid #10121a; box-shadow: 0 0 6px #fff, 0 0 12px #fff, 0 0 18px rgba(200,220,255,0.8); }
        .control-group input[type="number"] { width: 55px; flex-shrink: 0; text-align: right; padding: 5px 6px; background-color: rgba(20, 22, 30, 0.8); color: #66ffee; border: 1px solid rgba(80, 90, 120, 0.9); border-radius: 4px; -moz-appearance: textfield; appearance: textfield; font-size: 12px; font-weight: 500; box-shadow: inset 0 1px 3px rgba(0,0,0,0.3); }
        .control-group input[type="number"]::-webkit-outer-spin-button, .control-group input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .button-group { display: flex; gap: 10px; margin-top: 8px; }
        .button-group button { flex-grow: 1; }
        #resizeHandle { position: absolute; bottom: 0; right: 0; width: 16px; height: 16px; cursor: nwse-resize; z-index: 1000; display: flex; align-items: flex-end; justify-content: flex-end; opacity: 0.4; }
        #resizeHandle::before { content: ""; display: block; width: 8px; height: 8px; border-right: 2.5px solid #66ffee; border-bottom: 2.5px solid #66ffee; margin: 0 2px 2px 0; opacity: 0.6; }
        #resizeHandle:hover { opacity: 0.8; }
        .record-button { padding: 0; background-color: #282c34; border: 1px solid #4f5661; cursor: pointer; border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: background-color 0.2s, transform 0.15s ease, box-shadow 0.15s ease; box-shadow: 0 2px 5px rgba(0,0,0,0.3); flex-shrink: 0; color: #e8e8e8; }
        .record-button:hover { background-color: #3a3f47; transform: scale(1.05); box-shadow: 0 4px 10px rgba(0,0,0,0.4); }
        .record-button:active { background-color: #1c1e22; transform: scale(1); }
        .record-button.is-recording { animation: blink 1.5s linear infinite; }
        .record-button svg { display: block; margin: auto; }
        #fileUploadInput { background-color: rgba(20, 22, 30, 0.8); color: #e8e8e8; border: 1px solid rgba(80, 90, 120, 0.9); border-radius: 4px; padding: 4px; font-size: 11px; flex-grow: 1; }
        #fileUploadInput::file-selector-button { background-color: #3a3f47; color: #e8e8e8; border: none; padding: 3px 6px; border-radius: 3px; cursor: pointer; margin-right: 8px; }
        #snapshotButton { background-color: rgba(50, 205, 50, 0.15); border: 1px solid rgba(50, 205, 50, 0.6); color: #90ee90; }
        #snapshotButton:hover { background-color: rgba(50, 205, 50, 0.3); box-shadow: 0 0 10px rgba(50, 205, 50, 0.5); color: #d0ffd0; }
        #snapshotButton svg { width: 16px; height: 16px; fill: currentColor; }
        #refreshButton { background-color: rgba(65, 105, 225, 0.15); border: 1px solid rgba(65, 105, 225, 0.6); color: #90a9ee; }
        #refreshButton:hover { background-color: rgba(65, 105, 225, 0.3); box-shadow: 0 0 10px rgba(65, 105, 225, 0.5); color: #ccd6ff; }
        #switchCameraButton { background-color: rgba(255, 165, 0, 0.15); border: 1px solid rgba(255, 165, 0, 0.6); color: #ffd280; }
        #switchCameraButton:hover { background-color: rgba(255, 165, 0, 0.3); box-shadow: 0 0 10px rgba(255, 165, 0, 0.5); color: #ffe0b3; }
        #presetSelector { background-color: rgba(20, 22, 30, 0.8); color: #e8e8e8; border: 1px solid rgba(80, 90, 120, 0.9); border-radius: 4px; padding: 5px; font-size: 12px; width: 100%; margin-top: 5px; }
        #effectSelector { background-color: rgba(20, 22, 30, 0.8); color: #e8e8e8; border: 1px solid rgba(80, 90, 120, 0.9); border-radius: 4px; padding: 5px; font-size: 12px; width: 100%; margin-top: 5px; }
        .section-title { font-size: 13px; font-weight: 600; color: #66ffee; margin-top: 10px; margin-bottom: 5px; text-shadow: 0 0 5px rgba(100, 200, 255, 0.3); }
        .tab-buttons { display: flex; gap: 5px; margin-bottom: 10px; }
        .tab-button { flex: 1; padding: 6px 8px; background-color: rgba(20, 22, 30, 0.5); border: 1px solid rgba(80, 90, 120, 0.5); border-radius: 4px; color: #aaa; cursor: pointer; font-size: 11px; transition: all 0.2s ease; }
        .tab-button:hover { background-color: rgba(40, 45, 60, 0.7); color: #ddd; }
        .tab-button.active { background-color: rgba(80, 100, 140, 0.5); color: #fff; box-shadow: 0 0 10px rgba(100, 150, 255, 0.2); border-color: rgba(100, 120, 180, 0.8); }
        .tab-content { display: none; }
        .tab-content.active { display: flex; flex-direction: column; gap: 10px; }
        
        #floatingRandomizeButton {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 999;
            padding: 8px 12px;
            background: linear-gradient(120deg, red, orange, yellow, green, blue, indigo, violet, red);
            background-size: 300% 300%;
            animation: rainbowBackground 8s linear infinite;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            transition: transform 0.15s ease, box-shadow 0.15s ease;
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            opacity: 0.85;
        }

        #floatingRandomizeButton:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 15px rgba(0,0,0,0.4);
            opacity: 1;
        }

        #floatingRandomizeButton:active {
            transform: translateY(0px) scale(1);
            animation-duration: 4s;
        }
